;; -*- mode: clojure;-*-

(ns torque.lang.predicates
  (:use
    [torque.lang.protocols]
    [torque.lang.boot]
    [torque.lang.def]
    [torque.lang.let]))

(def ^:macro and
  "Evaluates exprs one at a time, from left to right. If a form
  returns logical false (nil or false), and returns that value and
  doesn't evaluate any of the other expressions, otherwise it returns
  the value of the last expr. (and) returns true."
  (fn
    ([]  true)
    ([x] x)
    ([x & next]
     `(let [and# ~x]
        (if and# (and ~@next) and#)))))

(def ^:macro or
  (fn
    ([]  nil)
    ([x] x)
    ([x & xs]
     `(let [or# ~x]
        (if or# or# (or ~@xs))))))

;; (defn pos? [x]
;;   (torque.core.builtin/> x 0))

;; (defn neg? [x]
;;   (torque.core.builtin/< x 0))

;; (defn zero? [x]
;;   (torque.core.builtin/== x 0))
